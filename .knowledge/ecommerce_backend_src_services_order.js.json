{"is_source_file": true, "format": "JavaScript", "description": "This file contains service functions related to order management in an e-commerce backend, including order creation, listing, retrieval, status updates, cancellation, and return requests.", "external_files": ["../models/Order", "../models/Cart", "../models/Coupon", "../models/Product", "../utils/payment"], "external_methods": ["require('../models/Order')", "require('../models/Cart')", "require('../models/Coupon')", "require('../models/Product')", "createPaymentSession"], "published": ["create", "list", "getById", "updateStatusAdmin", "cancel", "requestReturn"], "classes": [], "methods": [{"name": "create(userId, payload)", "description": "Creates a new order from the user's cart, supports Cash on Delivery (COD) or Prepaid methods, updates stock, clears the cart, and initiates payment session if prepaid.", "scope": "", "scopeKind": ""}, {"name": "list(userId, filterAdmin = false)", "description": "Lists orders; either all orders for admin or user's own orders.", "scope": "", "scopeKind": ""}, {"name": "getById(userId, id, admin = false)", "description": "Retrieves detailed information about a specific order, with access control for user and admin.", "scope": "", "scopeKind": ""}, {"name": "updateStatusAdmin(id, status)", "description": "Allows admin to update the status of an order.", "scope": "", "scopeKind": ""}, {"name": "cancel(userId, id)", "description": "Allows a user to cancel an order if it hasn't been shipped or delivered.", "scope": "", "scopeKind": ""}, {"name": "requestReturn(userId, id)", "description": "Allows a user to request a return after the order has been delivered.", "scope": "", "scopeKind": ""}], "calls": ["Cart.findOne", "Coupon.findById", "Order.create", "Product.findByIdAndUpdate", "cart.save", "createPaymentSession", "Order.find", "Order.findById", "Order.findByIdAndUpdate", "Order.save"], "search-terms": ["order creation", "order management", "payment session", "order status", "cart handling"], "state": 2, "file_id": 38, "knowledge_revision": 85, "git_revision": "", "ctags": [{"_type": "tag", "name": "Cart", "path": "/home/kavia/workspace/code-generation/modern-e-commerce-platform-220291-220289/ecommerce_backend/src/services/order.js", "pattern": "/^const Cart = require('..\\/models\\/Cart');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "Coupon", "path": "/home/kavia/workspace/code-generation/modern-e-commerce-platform-220291-220289/ecommerce_backend/src/services/order.js", "pattern": "/^const Coupon = require('..\\/models\\/Coupon');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "Joi", "path": "/home/kavia/workspace/code-generation/modern-e-commerce-platform-220291-220289/ecommerce_backend/src/services/order.js", "pattern": "/^const Joi = require('joi');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "Order", "path": "/home/kavia/workspace/code-generation/modern-e-commerce-platform-220291-220289/ecommerce_backend/src/services/order.js", "pattern": "/^const Order = require('..\\/models\\/Order');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "Product", "path": "/home/kavia/workspace/code-generation/modern-e-commerce-platform-220291-220289/ecommerce_backend/src/services/order.js", "pattern": "/^const Product = require('..\\/models\\/Product');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "cancel", "path": "/home/kavia/workspace/code-generation/modern-e-commerce-platform-220291-220289/ecommerce_backend/src/services/order.js", "pattern": "/^async function cancel(userId, id) {$/", "language": "JavaScript", "kind": "function", "signature": "(userId, id)"}, {"_type": "tag", "name": "create", "path": "/home/kavia/workspace/code-generation/modern-e-commerce-platform-220291-220289/ecommerce_backend/src/services/order.js", "pattern": "/^  create,$/", "language": "JavaScript", "kind": "field", "scope": "module.exports", "scopeKind": "class"}, {"_type": "tag", "name": "create", "path": "/home/kavia/workspace/code-generation/modern-e-commerce-platform-220291-220289/ecommerce_backend/src/services/order.js", "pattern": "/^async function create(userId, payload) {$/", "language": "JavaScript", "kind": "function", "signature": "(userId, payload)"}, {"_type": "tag", "name": "createSchema", "path": "/home/kavia/workspace/code-generation/modern-e-commerce-platform-220291-220289/ecommerce_backend/src/services/order.js", "pattern": "/^const createSchema = Joi.object({$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "delivery", "path": "/home/kavia/workspace/code-generation/modern-e-commerce-platform-220291-220289/ecommerce_backend/src/services/order.js", "pattern": "/^  cart.totals = { subTotal: 0, discount: 0, tax: 0, delivery: 0, grandTotal: 0 };$/", "language": "JavaScript", "kind": "property", "scope": "cart.totals", "scopeKind": "class"}, {"_type": "tag", "name": "discount", "path": "/home/kavia/workspace/code-generation/modern-e-commerce-platform-220291-220289/ecommerce_backend/src/services/order.js", "pattern": "/^  cart.totals = { subTotal: 0, discount: 0, tax: 0, delivery: 0, grandTotal: 0 };$/", "language": "JavaScript", "kind": "property", "scope": "cart.totals", "scopeKind": "class"}, {"_type": "tag", "name": "getById", "path": "/home/kavia/workspace/code-generation/modern-e-commerce-platform-220291-220289/ecommerce_backend/src/services/order.js", "pattern": "/^async function getById(userId, id, admin = false) {$/", "language": "JavaScript", "kind": "function", "signature": "(userId, id, admin = false)"}, {"_type": "tag", "name": "grandTotal", "path": "/home/kavia/workspace/code-generation/modern-e-commerce-platform-220291-220289/ecommerce_backend/src/services/order.js", "pattern": "/^  cart.totals = { subTotal: 0, discount: 0, tax: 0, delivery: 0, grandTotal: 0 };$/", "language": "JavaScript", "kind": "property", "scope": "cart.totals", "scopeKind": "class"}, {"_type": "tag", "name": "list", "path": "/home/kavia/workspace/code-generation/modern-e-commerce-platform-220291-220289/ecommerce_backend/src/services/order.js", "pattern": "/^async function list(userId, filterAdmin = false) {$/", "language": "JavaScript", "kind": "function", "signature": "(userId, filterAdmin = false)"}, {"_type": "tag", "name": "requestReturn", "path": "/home/kavia/workspace/code-generation/modern-e-commerce-platform-220291-220289/ecommerce_backend/src/services/order.js", "pattern": "/^async function requestReturn(userId, id) {$/", "language": "JavaScript", "kind": "function", "signature": "(userId, id)"}, {"_type": "tag", "name": "subTotal", "path": "/home/kavia/workspace/code-generation/modern-e-commerce-platform-220291-220289/ecommerce_backend/src/services/order.js", "pattern": "/^  cart.totals = { subTotal: 0, discount: 0, tax: 0, delivery: 0, grandTotal: 0 };$/", "language": "JavaScript", "kind": "property", "scope": "cart.totals", "scopeKind": "class"}, {"_type": "tag", "name": "tax", "path": "/home/kavia/workspace/code-generation/modern-e-commerce-platform-220291-220289/ecommerce_backend/src/services/order.js", "pattern": "/^  cart.totals = { subTotal: 0, discount: 0, tax: 0, delivery: 0, grandTotal: 0 };$/", "language": "JavaScript", "kind": "property", "scope": "cart.totals", "scopeKind": "class"}, {"_type": "tag", "name": "totals", "path": "/home/kavia/workspace/code-generation/modern-e-commerce-platform-220291-220289/ecommerce_backend/src/services/order.js", "pattern": "/^  cart.totals = { subTotal: 0, discount: 0, tax: 0, delivery: 0, grandTotal: 0 };$/", "language": "JavaScript", "kind": "class", "scope": "cart", "scopeKind": "class"}, {"_type": "tag", "name": "updateStatusAdmin", "path": "/home/kavia/workspace/code-generation/modern-e-commerce-platform-220291-220289/ecommerce_backend/src/services/order.js", "pattern": "/^async function updateStatusAdmin(id, status) {$/", "language": "JavaScript", "kind": "function", "signature": "(id, status)"}], "hash": "60863e0a92c2b08460bf8c1276bd46a8", "format-version": 4, "code-base-name": "ecommerce_backend", "filename": "ecommerce_backend/src/services/order.js", "fields": [{"name": "create,", "scope": "module.exports", "scopeKind": "class", "description": "unavailable"}, {"name": "cart.totals = { subTotal: 0, discount: 0, tax: 0, delivery: 0, grandTotal: 0 };", "scope": "cart.totals", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"85": ""}]}